<template>
  <v-row align="center" justify="center">
<!--    IMAGEN -->
    <v-col
      cols="8"
      class="pa-0 ma-0"
      style="background-color: black"
    >
     <v-img
        src="/images/logo-degubar.png"
        height="100vh"
        contain
        class="pt-1"
      />
    </v-col>
<!--    LOGIN FORM-->
    <v-col
      cols="12"
      sm="8"
      md="4"
      class="d-flex align-center justify-center full-height">
      <v-card
        class=" elevation-0 pa-1"
        light
        height=""
        color="white"
      >
<!--        <v-alert v-show="error.status" type="error">{{ error.texto }}</v-alert>-->
        <h1 class="text-h3 text-md-h4 pl-3 font-weight-light">
          Bienvenido a 
         <span class="primary--text font-weight-black"> Degubar</span>!
        </h1>
        <v-card-subtitle class="mt-0 pt-0" v-text="'Inicie sesi칩n para comenzar a trabajar'" />
        <v-form>
          <v-card-text>
            <v-text-field v-model="form.username" outlined label="Usuario" />
            <v-text-field
              v-model="form.password"
              :type="showPassword ? 'text' : 'password'"
              outlined
              label="Contrase침a"
              :append-icon="showPassword ? 'mdi-eye' : 'mdi-eye-off'"
              @click:append="showPassword = !showPassword"
              @keyup.enter="login"
            />
            <div class="text-right mt-n5">
              <v-btn text color="primary" x-small right
              >Olvidaste la contrase침a?</v-btn
              >
            </div>
          </v-card-text>
          <v-card-actions>
            <v-btn
              class="mx-auto"
              :loading="loading"
              color="primary"
              :disabled="$nuxt.isOffline || loading"
              @click="login"
            >Iniciar Sesi칩n</v-btn>
          </v-card-actions>
          <v-divider class="mt-5"></v-divider>
        </v-form>
        <div class="text-center">
          <span class="font-weight-light grey--text ">v1.0.0</span>
        </div>
      </v-card>

    </v-col>
  </v-row>
</template>

<script>
export default {
  name: 'Login',
  middleware: 'guest',
  data: () => ({
    form: {
      username: "",
      password: ""
    },
    loading: false,
    error: {
      status: false,
      type: "",
      texto: ""
    },
    showPassword: "",
  }),
    head: {
      title: "Login"
    },
  methods: {
    capitalize(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
    },
    async login() {
      try {
        this.loading = true;
        await this.$auth.loginWith("local", { data: this.form })
        await this.$auth.$storage.getUniversal("user");
        await this.$router.push({path: "/db-admin/dashboard"});
      } catch (err) {
          console.log(err);
      } finally {
        this.loading = false;
      }
    }
  }
}
</script>

<style lang="scss" scoped>
.full-height {
  min-height: 100vh;
  height: 100vh;
  background-color: #fff;
}
</style>
